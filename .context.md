# Digital Garden - Project Context

**Project Name:** Digital Garden
**Owner:** Kike López (Enrique López de Andrés)
**Type:** Next.js 16 Full-Stack Application
**Repository:** https://github.com/kikelop/digital-garden.git
**Live Site:** https://garden.kikelopez.es
**Last Updated:** 2026-02-13

---

## Project Overview

Digital Garden is a knowledge management and content publishing platform built with Next.js. It serves as a personal knowledge base and blog where Kike López can organize, filter, and share his thoughts, notes, and articles.

**Key Features:**
- Browse published articles/notes in a grid/list layout
- Full-text search and filtering by tags
- Pin important posts to the top
- Notion CMS integration for content management
- Responsive design (mobile-first)
- Clean, minimalist UI aligned with portfolio branding

---

## Project Structure

```
digital-garden/
├── app/
│   ├── garden/
│   │   └── [slug]/
│   │       └── page.tsx          # Individual article/post page
│   ├── page.tsx                  # Main landing/grid page
│   ├── layout.tsx                # Root layout
│   ├── globals.css               # Global styles
│   ├── page.module.css           # Home page styles
│   └── debug/
│       └── page.tsx              # Debug page (dev only)
├── components/
│   ├── Header.tsx                # Navigation header
│   ├── FilterPanel.tsx           # Search & tag filters
│   └── [other components]
├── lib/
│   └── notion.ts                 # Notion API integration
├── public/
│   ├── [SVG icons]
│   └── [static assets]
├── package.json                  # Dependencies & scripts
├── next.config.ts                # Next.js configuration
├── tsconfig.json                 # TypeScript config
└── .context.md                   # THIS FILE - Project context

```

---

## Tech Stack

| Layer | Technology |
|-------|-----------|
| **Framework** | Next.js 16.1.3 with Turbopack |
| **Language** | TypeScript |
| **Styling** | CSS (globals.css + module.css) |
| **CMS** | Notion API |
| **Hosting** | Vercel |
| **Font** | Inter Display (custom WOFF2) |
| **Package Manager** | npm |

---

## Key Concepts

### Content Management
- **Source:** Notion database (content is written in Notion)
- **Fetching:** `lib/notion.ts` handles API calls to Notion
- **Rendering:** `renderBlock()` converts Notion blocks to HTML
- **Revalidation:** ISR (Incremental Static Regeneration) every 60 seconds

### Styling System

**Global Colors:**
```css
--color-accent: #FF4921;           /* Orange - primary accent */
--color-accent-foreground: #ffffff;
--color-text-primary: #000000;
--color-text-body: #555555;
--color-text-muted: #999999;
--color-border: #e5e5e5;
--color-bg: #ffffff;
--color-bg-muted: #f9f9f9;
```

**Layout:**
```css
--container-max-width: 1140px;     /* Old value, now using 100% width */
--header-height: 4rem;
```

### Pages

| Page | Path | Purpose |
|------|------|---------|
| Home/Grid | `/` | Browse all posts with filters |
| Article | `/garden/[slug]` | Read individual post |
| Debug | `/debug` | Development debugging page |

---

## Current Session Changes (2026-02-14)

### Major Changes Summary

1. **FIXED YOUTUBE VIDEO EMBEDS** ✅ - Videos now display correctly
   - Root cause: `video` block type wasn't converting YouTube URLs to embed format
   - Solution: Added YouTube URL conversion logic to video case (same as embed/bookmark)
   - Videos from Notion now convert `youtube.com/watch?v=XXX` → `youtube.com/embed/XXX`

2. **Added iframe styling** - Videos are responsive with aspect-ratio 16:9
3. **Cleaned up debug logging** - Removed console logs after verification

**Previous Session Summary:**
1. **Moved all inline styles to CSS** - No style attributes in JSX
2. **Added InterDisplay font** - Same typography as portfolio
3. **Fixed layout widths** - Header and body span 100%
4. **Added video/embed support** - YouTube, Vimeo, and Notion embeds (now fully working)
5. **Separated post titles** - Different sizes for homepage vs article

### File Modifications

#### 1. `app/globals.css` (Updated 2026-02-14)
**Video Fix Changes:**
- Added `.content iframe` styling with:
  - `width: 100%; max-width: 100%;`
  - `border: none; border-radius: 8px;`
  - `aspect-ratio: 16 / 9;` for responsive sizing
- Added `.content figure iframe` for proper aspect ratio handling

**Previous Changes:**
**What Changed (Previous Session):**
**What Changed:**
- Added @font-face for InterDisplay (9 weights)
- Added `.post-main`, `.post-article`, `.post-meta`, `.post-tags`, `.post-tag`, `.article-title` styles
- All inline styles from JSX moved here
- Added comprehensive `.content` styling (paragraphs, blockquotes, lists, code, images, etc)
- Made header span 100% width
- Made body layout span 100% width
- Updated spacing: h1 margin-bottom 32px, blockquote/lists margin-bottom 2em

#### 2. `app/garden/[slug]/page.tsx`
**What Changed:**
- Removed ALL inline `style` attributes
- Added semantic CSS classes: `.post-main`, `.post-article`, `.article-title`, `.post-meta`, `.post-tags`, `.post-tag`
- Cleaner, more maintainable JSX code

#### 3. `lib/notion.ts` (Updated 2026-02-14 - VIDEO FIX)
**CRITICAL FIX - Video Blocks:**
- **Issue:** Video block type wasn't converting YouTube URLs to embed format
- **Solution:** Added YouTube URL regex patterns to `video` case:
  - `/youtube\.com\/watch\?v=([^&]+)/` - Extracts ID from watch URLs
  - `/youtu\.be\/([^?&]+)/` - Extracts ID from short URLs
  - `/youtube\.com\/embed\/([^?&]+)/` - Handles already-embed URLs
- **Result:** `https://www.youtube.com/watch?v=3JiVDYL20G4&t=1s` → `https://www.youtube.com/embed/3JiVDYL20G4`

**Previous Changes:**
- Added support for `video` blocks (embedded videos from Notion) ✅ NOW WORKING
- Added support for `embed` blocks (YouTube, Vimeo, Notion embeds) ✅
- Added support for `bookmark` blocks (links with metadata) ✅
- Added YouTube URL conversion logic (watch?v= → /embed/) ✅
- Added Notion embed handling (notion.so URLs) ✅

#### 4. Layout & Typography
**Header:** `.post-main` - max-width: none, 100% width
**Article Title:** `.article-title` - 32px, font-weight 600, line-height 1.2
**Post Metadata:** 14px, color #121212, proper spacing
**Content Text:** All #121212, proper line-height and margins

---

## Design Standards

### Typography
- **Article Text:** #121212 (dark gray/black)
- **Metadata:** #121212
- **Muted Text:** #999999
- **Links:** #0066cc (blue)

### Spacing
- **Content Margins:** 1em default
- **Blockquote Padding:** 1em left padding
- **List Items:** 24px left margin

### Colors
- **Primary Accent:** #FF4921 (orange) - used for blockquote borders, hover states
- **Backgrounds:** #ffffff (white) or #f9f9f9 (light)
- **Borders:** #e5e5e5 (light gray)

---

## Working with This Project

### Local Development
```bash
# Install dependencies
npm install

# Start dev server (with live reload)
npm run dev

# Build for production
npm run build

# Run production build locally
npm start
```

**Dev Server:** http://localhost:3000

### Making Changes

1. **For Article Styling:**
   - Edit `app/globals.css` (`.content` section)
   - Test in browser: `/garden/[any-article-slug]`

2. **For Layout/Header:**
   - Edit `app/globals.css` (`.header`, `.page-layout`)
   - Test on home page: `/`

3. **For Components:**
   - Edit `components/*.tsx`
   - Changes auto-reload in dev mode

### Deployment
- **Host:** Vercel
- **Trigger:** Automatic on push to `main` branch
- **Build Time:** ~24 seconds
- **Status:** Check at Vercel dashboard

---

## Recent Fixes & Improvements

✅ **Header now spans full width** - Previously limited to 1140px max-width
✅ **Body now spans full width** - Matches header behavior
✅ **Article text color unified to #121212** - Consistent typography
✅ **Blockquote accent color** - Orange (#FF4921) for brand consistency
✅ **Moved inline styles to CSS** - Better maintainability

---

## Known Issues & TODOs

- [x] ✅ **YouTube video embeds fixed (2026-02-14)** - Videos now display correctly in articles
- [ ] Verify responsive design at different breakpoints
- [ ] Test article rendering with complex Notion blocks
- [ ] Consider optimizing Notion API calls (caching)

---

## Development Workflow (Updated 2026-02-13)

### Tool Assignment
- **Claude Code** → Main development tool for all changes
- **ChatGPT (VSCode)** → Quick text edits, minor front-end adjustments only
- **Cursor/Codex** → ⚠️ DO NOT USE (causes localhost conflicts)

### Making Changes

**For Complex Changes (Claude Code):**
1. Read `.context.md` to understand current state
2. Make changes to files
3. Test locally at http://localhost:3000
4. Document changes in `.context.md`
5. When ready, commit and push

**For Quick Text Edits (ChatGPT + VSCode):**
1. Use ChatGPT connected to VSCode for simple CSS tweaks
2. Small text updates
3. Non-structural changes only
4. Always update `.context.md` after changes

**NEVER use Cursor/Codex** - it creates node process conflicts

### How to Update This File

1. **After making changes:**
   - Document what you changed in "Current Session Changes"
   - Note which files were modified
   - Include lines changed and reason

2. **Before switching tools:**
   - Ensure `.context.md` is up to date
   - Verify localhost is working at http://localhost:3000

3. **Before Final Commit:**
   - Check all changes are documented
   - Do final review in localhost
   - Create single comprehensive commit with everything

---

## Links & Resources

- **GitHub Repo:** https://github.com/kikelop/digital-garden
- **Live Site:** https://garden.kikelopez.es
- **Notion API Docs:** https://developers.notion.com
- **Next.js Docs:** https://nextjs.org/docs
- **Vercel Dashboard:** https://vercel.com

---

## Contact & Author Info

**Author:** Kike López (Enrique López de Andrés)
**Portfolio:** https://kikelopez.es
**LinkedIn:** https://www.linkedin.com/in/enriquelopezdeandres/
**Behance:** https://www.behance.net/enriquelopez
**Dribbble:** https://dribbble.com/enriquelop
